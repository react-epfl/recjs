var APP_ROOT = process.env.PWD
  , lib = require(APP_ROOT + "/lib/helper")

if (!global.GENTLY) {
	global.GENTLY = new (require('gently'))
}
// to avoid problem with limited number of listeners
process.setMaxListeners(0)

module.exports = {
	// interface to global GENTLY object
	hijacked: GENTLY.hijacked
	// returns a path relative to app
, fullPath: function (path) {
		return APP_ROOT + path
	}
	// require relative to app
, require: function (path) {
   	// /home/project/my_file.js
		return require(APP_ROOT + path)
	}
	// loads a required controller
, controller: function (controller) {
   	// /home/project/app/controllers/app_controller
		return require(APP_ROOT + "/app/controllers/" + controller + "_controller")
	}
	// loads a required model
, model: function (app, name) {
		var AppModel = require(APP_ROOT + "/app/models/app_model");
		var Model = require(APP_ROOT + "/app/models/" + name);
		lib.inherits(Model, AppModel);
		Model.app = app;
		Model.prototype.app = app;

		return Model;
	}
}

